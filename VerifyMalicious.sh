#!/bin/bash

if [[ ! -d "exe-dir/malicious" ]]; then
    echo "Error, exe-dir not found."
    exit
fi

if [[ ! -e "classifier/classifier.pkl" ]]; then
    echo "Error, couldn't find the classifier."
    exit
fi

if [[ ! -e "classifier/features.pkl" ]]; then
    echo "Error, couldn't find the features."
    exit
fi

echo "" > malware.txt
i=1
for file in exe-dir/malicious/*; do
    #OUTPUT=$(python checkfile.py $file | awk '{print $3,$5}')
    python checkfile.py $file | awk '{print $3,$5}' >> malware.txt
    #FILE=$(echo "$OUTPUT" | awk '{print $3,$5}')
    #BELIEF=$(echo "$OUTPUT" | cut -d ' ' -f 3)
    #printf "%-2s. %-45s %-10s\n" "$i" "$FILE" "$BELIEF"
    print $OUTPUT
    i=$((i+1))
done

cat malware.txt | awk '{print $2}'
